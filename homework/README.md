# ДЗ: ITSM / Customer Support Ticket Routing (Multi-task NLP)

## Цель
Построить модель, которая по тексту тикета предсказывает:
- **queue** (52 класса) — основная задача (маршрутизация)
- **priority** (5 классов)
- **type** (5 классов): `Incident / Request / Problem / Change / Unknown`  
  где `Unknown` = отсутствующая разметка `type`.

## Данные
Источник: Hugging Face датасет `Tobi-Bueck/customer-support-tickets` (61 765 строк, EN/DE).  
Используйте поля:
- вход: `subject`, `body`
- лейблы: `queue`, `priority`, `type`

Датасет в репозиторий не кладём. Разбиение фиксируем индексами (см. `data/*.txt`).

## Фиксированный split (обязателен)
Seed: 42, размеры:
- train: 49412
- val: 6176
- test: 6177

Файлы:
- `data/train_idx.txt`
- `data/val_idx.txt`
- `data/test_idx.txt`

Правило: после загрузки датасета берёте строки по `row_idx` из этих файлов.  
Split подготовлен так, что одинаковые тексты (`subject+body`) не пересекаются между train/val/test.

## Что сделать (минимум)
1) EDA: распределение классов `queue`, длины текстов.
2) Baseline: TF-IDF + линейная модель для `queue` (macro-F1 и accuracy).
3) Transformer fine-tuning на multitask (`queue`, `priority`, `type`).
4) ...
5) profit
 
P.S. а вообще покрутите повертите, хоть LLM хоть KNN можете юзать поощеряется качественное исследование каждого из методов
P.P.S. оооочень интересует введение такой метрики как "confidence", например взять 70% наиболее "уверенных" предсказаний и замерить метрику на них, и гипотетически допустить какое будет качество, если 30% ушло бы на ручную разметку (так для всех пропорций посчитать не тока 70/30)

## Метрики и скоринг
Считаем метрики на **test**:
- основная: **Macro-F1(queue)**
- дополнительные: **Accuracy(queue)**, **Accuracy(priority)**, **Accuracy(type)**

Итоговый score:
```

Score = 0.70 * MacroF1(queue) + 0.15 * Acc(priority) + 0.15 * Acc(type)

```
Тай-брейк: (1) MacroF1(queue), (2) Acc(queue)

## Что сдавать
- Праймовый юпитер-ноутбук (где вы постараетесь оформить красиво), у вас могу быть другие юпитеры, но нужно постараться объединить результаты/работу в 1 праймовый (он должен быть полностью запущен и сохранен и желательно без артефактов логов на 100000 строк, читаемый юпитер)
- Ссылка на репозиторий с вашим кодом/экспериментами которая сдается через PR к основному репозиторию